{"version":3,"file":"section-to-sidebar-items.js","mappings":"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","sources":["webpack://jenkins-ui/./src/main/js/util/dom.js","webpack://jenkins-ui/./src/main/js/section-to-sidebar-items.js"],"sourcesContent":["export function createElementFromHtml(html) {\n  const template = document.createElement(\"template\");\n  template.innerHTML = html.trim();\n  return template.content.firstElementChild;\n}\n\nexport function toId(string) {\n  return string\n    .trim()\n    .replace(/[\\W_]+/g, \"-\")\n    .toLowerCase();\n}\n","import { createElementFromHtml, toId } from \"./util/dom\";\n\nconst HEADER_SELECTOR =\n  \".config-table .jenkins-app-bar h2, .config-table > .jenkins-section > .jenkins-section__title\";\nconst DEFAULT_ICON = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path d=\"M262.29 192.31a64 64 0 1057.4 57.4 64.13 64.13 0 00-57.4-57.4zM416.39 256a154.34 154.34 0 01-1.53 20.79l45.21 35.46a10.81 10.81 0 012.45 13.75l-42.77 74a10.81 10.81 0 01-13.14 4.59l-44.9-18.08a16.11 16.11 0 00-15.17 1.75A164.48 164.48 0 01325 400.8a15.94 15.94 0 00-8.82 12.14l-6.73 47.89a11.08 11.08 0 01-10.68 9.17h-85.54a11.11 11.11 0 01-10.69-8.87l-6.72-47.82a16.07 16.07 0 00-9-12.22 155.3 155.3 0 01-21.46-12.57 16 16 0 00-15.11-1.71l-44.89 18.07a10.81 10.81 0 01-13.14-4.58l-42.77-74a10.8 10.8 0 012.45-13.75l38.21-30a16.05 16.05 0 006-14.08c-.36-4.17-.58-8.33-.58-12.5s.21-8.27.58-12.35a16 16 0 00-6.07-13.94l-38.19-30A10.81 10.81 0 0149.48 186l42.77-74a10.81 10.81 0 0113.14-4.59l44.9 18.08a16.11 16.11 0 0015.17-1.75A164.48 164.48 0 01187 111.2a15.94 15.94 0 008.82-12.14l6.73-47.89A11.08 11.08 0 01213.23 42h85.54a11.11 11.11 0 0110.69 8.87l6.72 47.82a16.07 16.07 0 009 12.22 155.3 155.3 0 0121.46 12.57 16 16 0 0015.11 1.71l44.89-18.07a10.81 10.81 0 0113.14 4.58l42.77 74a10.8 10.8 0 01-2.45 13.75l-38.21 30a16.05 16.05 0 00-6.05 14.08c.33 4.14.55 8.3.55 12.47z\" fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"32\"/></svg>`;\n\nwindow.addEventListener(\"load\", function () {\n  const sidebar = document.querySelector(\"#side-panel\");\n  const sidebarItems = document.querySelector(\"#tasks\");\n  const sectionHeaders = document.querySelectorAll(HEADER_SELECTOR);\n\n  // Ensure sidebar is sticky\n  sidebar.classList.add(\"app-page-body__sidebar--sticky\");\n\n  // Create the sidebar items\n  sectionHeaders.forEach(function (header, i) {\n    const headerId = toId(header.textContent);\n    header.id = headerId;\n    const icon = header.querySelector(\"svg\")\n      ? header.querySelector(\"svg\").outerHTML\n      : DEFAULT_ICON;\n    const item = createElementFromHtml(`\n        <div class=\"task\">\n            <span class=\"task-link-wrapper\">\n                <button data-section-id=${headerId} class=\"task-link\">\n                    <span class=\"task-icon-link\">\n                        ${icon}\n                    </span>\n                    <span class=\"task-link-text\">\n                        ${header.textContent}\n                    </span>\n                </button>\n            </span>\n        </div>\n    `);\n    item.addEventListener(\"click\", () => {\n      const headerToScrollTo = document.getElementById(\n        item.querySelector(\".task-link\").dataset.sectionId\n      );\n      document.documentElement.scrollTop =\n        i === 0\n          ? 0\n          : headerToScrollTo.getBoundingClientRect().top + window.scrollY - 70;\n    });\n\n    sidebarItems.insertAdjacentElement(\"beforeend\", item);\n  });\n\n  // TODO - Remove when Matrix-Project plugin has been updated to only have one enable/disable project toggle\n  // Having multiple toggles on the same page for the same field corrupts submission for that field, so\n  // remove all but the first\n  document\n    .querySelectorAll(\".jenkins-form-item + span input[name='enable']\")\n    .forEach((input) => {\n      input.parentElement.remove();\n    });\n\n  document.addEventListener(\"scroll\", () => onScroll());\n  onScroll();\n});\n\n/**\n * Change the selected item depending on the user's vertical scroll position\n */\nfunction onScroll() {\n  const scrollY = Math.max(window.scrollY, 0);\n  const sectionHeaders = document.querySelectorAll(HEADER_SELECTOR);\n\n  let selectedSection = null;\n\n  // Calculate the top and height of each section to know when to switch selected sidebar item\n  sectionHeaders.forEach(function (section, i) {\n    const previousSection =\n      i === 1\n        ? document.querySelectorAll(\".jenkins-section\")[0]\n        : sectionHeaders[Math.max(i - 1, 0)].parentNode;\n    const viewportEntryOffset =\n      i === 0\n        ? 0\n        : section.parentNode.getBoundingClientRect().top +\n          window.scrollY -\n          previousSection.offsetHeight / 2;\n\n    if (scrollY >= viewportEntryOffset) {\n      selectedSection = section;\n    }\n  });\n\n  document.querySelectorAll(\".task-link--active\").forEach(function (selected) {\n    selected.classList.remove(\"task-link--active\");\n  });\n\n  document\n    .querySelector(\".task-link[data-section-id='\" + selectedSection.id + \"']\")\n    .classList.add(\"task-link--active\");\n}\n"],"names":["createElementFromHtml","html","template","document","createElement","innerHTML","trim","content","firstElementChild","toId","string","replace","toLowerCase","HEADER_SELECTOR","DEFAULT_ICON","window","addEventListener","sidebar","querySelector","sidebarItems","sectionHeaders","querySelectorAll","classList","add","forEach","header","i","headerId","textContent","id","icon","outerHTML","item","headerToScrollTo","getElementById","dataset","sectionId","documentElement","scrollTop","getBoundingClientRect","top","scrollY","insertAdjacentElement","input","parentElement","remove","onScroll","Math","max","selectedSection","section","previousSection","parentNode","viewportEntryOffset","offsetHeight","selected"],"sourceRoot":""}